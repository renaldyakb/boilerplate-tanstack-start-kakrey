import{S as E,s as I,h as j,g as z,n as N,u as _,r as a,a as R,b as D,c as p,t as f,j as t,B as m,d as u,I as L,L as k,C as Q,e as o,q as x,f as A}from"./index-BOzjwXpJ.js";import{u as U}from"./useSuspenseQuery-BNYerSAG.js";var $=class extends E{#t;#i=void 0;#e;#s;constructor(e,r){super(),this.#t=e,this.setOptions(r),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#t.defaultMutationOptions(e),I(this.options,r)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&j(r.mutationKey)!==j(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#n(e)}getCurrentResult(){return this.#i}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#r(),this.#n()}mutate(e,r){return this.#s=r,this.#e?.removeObserver(this),this.#e=this.#t.getMutationCache().build(this.#t,this.options),this.#e.addObserver(this),this.#e.execute(e)}#r(){const e=this.#e?.state??z();this.#i={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#n(e){N.batch(()=>{if(this.#s&&this.hasListeners()){const r=this.#i.variables,i=this.#i.context,n={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#s.onSuccess?.(e.data,r,i,n)}catch(s){Promise.reject(s)}try{this.#s.onSettled?.(e.data,null,r,i,n)}catch(s){Promise.reject(s)}}else if(e?.type==="error"){try{this.#s.onError?.(e.error,r,i,n)}catch(s){Promise.reject(s)}try{this.#s.onSettled?.(void 0,e.error,r,i,n)}catch(s){Promise.reject(s)}}}this.listeners.forEach(r=>{r(this.#i)})})}};function y(e,r){const i=_(),[n]=a.useState(()=>new $(i,e));a.useEffect(()=>{n.setOptions(e)},[n,e]);const s=a.useSyncExternalStore(a.useCallback(c=>n.subscribe(N.batchCalls(c)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),h=a.useCallback((c,l)=>{n.mutate(c,l).catch(R)},[n]);if(s.error&&D(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:h,mutateAsync:s.mutate}}const B=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],V=p("check",B);const F=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],H=p("circle-alert",F);const X=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],G=p("plus",X);const J=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],W=p("trash-2",J);const Y=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Z=p("x",Y);function w(e,r={}){const{type:i="info",description:n,action:s,closable:h=!0,duration:c=5e3}=r,l=String(Date.now()),d=i==="loading"?0:c;return f.custom(b=>{function M(){const[q,K]=a.useState(100);return a.useEffect(()=>{if(!d||d<=0||i==="loading")return;const P=Date.now(),g=setInterval(()=>{const T=Date.now()-P,v=Math.max(100-T/d*100,0);K(v),v<=0&&clearInterval(g)},50);return()=>clearInterval(g)},[]),!d||d<=0||i==="loading"?null:t.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 w-full overflow-hidden rounded-b bg-neutral-200/50",children:t.jsx("div",{className:u("h-full transition-all duration-75 ease-linear",i==="info"&&"bg-primary",i==="error"&&"bg-red-500",i==="success"&&"bg-green-500"),style:{width:`${q}%`}})})}function O(){switch(i){case"success":return t.jsx(Q,{className:"mt-0.5 shrink-0 text-green-600",size:18,"aria-hidden":"true"});case"error":return t.jsx(H,{className:"mt-0.5 shrink-0 text-red-600",size:18,"aria-hidden":"true"});case"loading":return t.jsx(k,{className:"mt-0.5 shrink-0 animate-spin",size:18,"aria-hidden":"true"});default:return t.jsx(L,{className:"mt-0.5 shrink-0",size:18,"aria-hidden":"true"})}}function S(){return u("relative z-50 max-w-[420px] bg-accent overflow-hidden rounded-lg border shadow-lg",i==="success"&&"border-green-400/10 ",i==="error"&&"border-red-400/10 ",i==="info"&&"border-primary/10",i==="loading"&&"")}return t.jsxs("div",{className:S(),children:[t.jsx("div",{className:"p-3",children:t.jsxs("div",{className:u(n&&"items-start",!n&&"items-center","flex gap-3"),children:[O(),t.jsxs("div",{className:u(n&&"flex-1 space-y-1",!n&&"flex items-center justify-between gap-7"),children:[t.jsx("p",{className:"text-foreground text-sm font-medium",children:e}),n&&t.jsx("p",{className:"text-[0.79rem] opacity-55",children:n}),s&&t.jsx("div",{className:u(n&&"mt-3 mb-2"),children:t.jsx(m,{size:"sm",variant:"outline",onClick:()=>{s.onClick(),f.dismiss(b)},className:"rounded-sm text-sm font-medium",children:s.label})})]}),h&&t.jsx(m,{variant:"ghost",size:"sm",className:"group h-6 w-6 shrink-0 p-0 hover:bg-gray-200/50",onClick:()=>f.dismiss(b),"aria-label":"Close notification",children:t.jsx(Z,{size:14,className:"opacity-60 transition-opacity group-hover:opacity-100","aria-hidden":"true"})})]})}),t.jsx(M,{})]})},{id:l,duration:d===0?1/0:d,position:"top-right"}),l}const C=(e,r)=>w(e,{...r,type:"success"}),ee=(e,r)=>w(e,{...r,type:"error"});function te({className:e,type:r,...i}){return t.jsx("input",{type:r,"data-slot":"input",className:u("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...i})}function se(){const[e,r]=a.useState(""),i=y(o.todo.create.mutationOptions({onSuccess:()=>{x.invalidateQueries({queryKey:o.todo.list.queryOptions().queryKey}),C("Todo created successfully"),r("")}})),n=s=>{s.preventDefault(),e.trim()&&i.mutate({title:e})};return t.jsxs("form",{onSubmit:n,className:"flex gap-2 mb-8",children:[t.jsx(te,{placeholder:"Add a new todo...",value:e,onChange:s=>r(s.target.value),disabled:i.isPending,className:"flex-1"}),t.jsxs(m,{type:"submit",disabled:i.isPending,children:[i.isPending?t.jsx(k,{className:"h-4 w-4 animate-spin"}):t.jsx(G,{className:"h-4 w-4 mr-2"}),"Add"]})]})}function ie(){const{data:e}=U(o.todo.list.queryOptions()),r=y(o.todo.create.mutationOptions({onSuccess:()=>{x.invalidateQueries({queryKey:o.todo.list.queryOptions().queryKey})}})),i=y(o.todo.toggle.mutationOptions({onSuccess:async s=>{await x.invalidateQueries({queryKey:o.todo.list.queryOptions().queryKey}),C(s.completed?"Todo completed":"Todo uncompleted",{action:{label:"Undo",onClick:()=>i.mutate({id:s.id,completed:!s.completed})}})}})),n=y(o.todo.delete.mutationOptions({onSuccess:async(s,h)=>{await x.invalidateQueries({queryKey:o.todo.list.queryOptions().queryKey});const c=e.find(l=>l.id===h.id);ee("Todo deleted",{action:{label:"Undo",onClick:()=>{c&&r.mutate({title:c.title})}}})}}));return e.length===0?t.jsx("div",{className:"text-center text-muted-foreground py-10",children:"No todos yet. Add one above!"}):t.jsx("div",{className:"space-y-4",children:e.map(s=>t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(m,{variant:s.completed?"default":"outline",size:"icon",className:"h-8 w-8 rounded-full",onClick:()=>i.mutate({id:s.id,completed:!s.completed}),disabled:i.isPending,children:s.completed?t.jsx(V,{className:"h-4 w-4"}):t.jsx("div",{className:"h-4 w-4"})}),t.jsx("span",{className:s.completed?"line-through text-muted-foreground":"font-medium",children:s.title})]}),t.jsx(m,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>n.mutate({id:s.id}),disabled:n.isPending,children:t.jsx(W,{className:"h-4 w-4"})})]},s.id))})}function oe(){return t.jsxs("div",{className:"container max-w-2xl py-10 mx-auto",children:[t.jsx("h1",{className:"text-3xl font-bold mb-8",children:"My Todos"}),t.jsxs("div",{className:"bg-background rounded-xl border p-6 shadow-sm",children:[t.jsx(se,{}),t.jsx(a.Suspense,{fallback:t.jsx(A,{}),children:t.jsx(ie,{})})]})]})}export{oe as component};
